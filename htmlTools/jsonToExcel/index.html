<html>

<head>
    <title>jsonToExcel</title>
    <meta charset="utf-8" />
</head>

<body>



    <script>
        var json = [
           
        ]
        console.info(json)

        var title = new Set()
        for (var i = 0, len = json.length; i < len; i++) {
            getTitle(json[i], title)
        }
        console.info("标题列表：", title)

        var data = []
        getData(json, data)

        console.info("数据集合：", data)


        function createExcel() {
            
        }



        // 获取数据
        function getData(json, data) {
            for (var i = 0, len = json.length; i < len; i++) {
                var d = json[i]
                var row = []

                title.forEach(element => {
                    var dd = d[element]

                    if (dd) {
                        if (typeof dd == 'object') {
                            row.push(JSON.stringify(dd))
                        } else {
                            row.push(dd)
                        }
                    } else {
                        row.push("")
                    }
                });

                data.push(row)
            }
        }

        // 获取标题
        function getTitle(data, title) {
            for (const key in data) {
                title.add(key)
            }
        }
    </script>
</body>

</html>